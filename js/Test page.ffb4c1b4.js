(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{4799:function(e,t,i){},"68f2":function(e,t,i){"use strict";i("4799")},c961:function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-page",{staticClass:"flex flex-center"},[i("div",{staticClass:"col"},[i("p",{staticClass:"row q-ma-md"},[e._v("Kelas Percobaan")]),i("div",{staticClass:"col"},[i("div",{staticClass:"row absolute-top-right q-mr-md"},[i("q-btn",{staticClass:"q-ma-sm",attrs:{round:"",flat:"",icon:"eva-bell-outline"},on:{click:e.notif}},[i("q-badge",{attrs:{color:"red",floating:""}},[e._v(e._s(e.unreadNotification))])],1)],1),e.showNotif?i("div",{staticClass:"row absolute-top-right q-mr-md q-mt-xl"},[i("div",{staticClass:"col",staticStyle:{height:"500px",verrflow:"scrool"}},e._l(e.notifications,(function(t,o){return i("div",{key:o,staticClass:"row"},[i("notification",{attrs:{data:t,user:e.user}})],1)})),0)]):e._e()]),i("div",{staticClass:"row"},[this.deviceMem?i("p",{staticClass:"glossy q-ma-sm"},[e._v("\n        Device processor : "+e._s(e.deviceMem)+"\n      ")]):e._e(),i("q-btn",{staticClass:"glossy q-ma-sm",attrs:{rounded:"",color:"deep-orange",label:"record"},on:{click:e.coba}}),i("q-btn",{staticClass:"glossy q-ma-sm",attrs:{rounded:"",color:"green",label:"hard login"},on:{click:e.write}}),i("q-btn",{staticClass:"glossy q-ma-sm",attrs:{rounded:"",color:"green",label:"hard logout"},on:{click:e.clear}}),i("q-btn",{staticClass:"glossy q-ma-sm",attrs:{"no-caps":"",rounded:"",color:"green",label:"get Notif"},on:{click:e.getNotif}}),i("q-btn",{staticClass:"glossy q-ma-sm",attrs:{rounded:"",color:"green",label:"convert"},on:{click:e.convert}}),i("q-btn",{staticClass:"glossy q-ma-sm",attrs:{rounded:"",color:"green",label:"send notif"},on:{click:e.download}}),i("q-btn",{staticClass:"glossy q-ma-sm",attrs:{rounded:"",color:"green",label:"Upload",disable:e.canUpload},on:{click:e.upload}}),e.device.length>1?i("q-btn",{staticClass:"glossy q-ma-sm",attrs:{rounded:"",color:"green",label:"swith cam"},on:{click:e.switchCam}}):e._e()],1),i("div",{staticClass:"row"}),i("div",{staticClass:"camera-frame"})])])},a=[],s=i("ded3"),n=i.n(s),l=(i("e6cf"),i("ddb0"),i("2b3d"),i("c19f"),i("ace4"),i("5cc6"),i("2f62")),c=i("a9ee");i("a9ee"),i("121f");var r={name:"PageIndex",components:{notification:()=>Promise.all([i.e(0),i.e(34)]).then(i.bind(null,"6d4f"))},data(){return{mytoken:"",imageCaptured:!1,recording:!1,recorder:"",videoData:null,canUpload:!0,device:[],currentStream:"",kamera:"",audioInput:"",counter:1,deviceMem:"",date:"",vPicked:null,showNotif:!0}},computed:n()(n()(n()(n()({},Object(l["d"])("messaging",["token"])),Object(l["c"])("notifications",["notifications"])),Object(l["c"])("users",["user"])),{},{unreadNotification(){let e=this.notifications.filter((e=>0==e.readed));return e.length}}),mounted(){},methods:n()(n()(n()({},Object(l["b"])("database",["sendVideo","convertVideo","convertOnly","sendMessage","getClient"])),Object(l["b"])("notifications",["addNotifications","getNotifByUserId","getNotidicationByCurrentId"])),{},{getNotif(){this.user.id;this.getNotidicationByCurrentId()},notif(){this.showNotif=!this.showNotif},convert(){let e=new FormData;e.append("title","coba convert"),e.append("video",this.vPicked),console.log(this.vPicked),this.$q.loading.show(),this.convertVideo(e).then((()=>{this.$q.loading.hide()})).catch((()=>{this.$q.loading.hide()}))},download(){let e={to:{user:["1","2"]},title:"Lelang Baru",link:"index",topik:{type:"lelang_almost",id:null}};this.addNotifications(e)},switchCam(){this.counter++,this.selectCons(),this.disableCamera(),navigator.mediaDevices.getUserMedia(this.kamera).then((e=>{this.$refs.video.srcObject=e})).catch((e=>{this.hasCameraSupport=!1}))},selectCons(){let e=0;2==this.device.length&&(e=this.counter%2);let t=this.device[e].id,i=this.audioInput.filter((e=>"default"===e.deviceId)),o=i[0].deviceId;console.log("audio",o);const a={audio:{deviceId:o?{exact:o}:void 0},volume:0,video:{deviceId:t?{exact:t}:void 0},echoCancelation:!0};this.kamera=a,console.log(a)},initEnviro(){this.$q.loading.show(),navigator.mediaDevices.enumerateDevices().then((e=>{console.log(e);let t=null;const i=e.filter((e=>"videoinput"===e.kind)),o=i.map((e=>t={id:e.deviceId,label:e.label,group:e.groupId})),a=e.filter((e=>"audioinput"===e.kind));this.device=o,this.audioInput=a,console.log(this.device),console.log(this.audioInput),this.selectCons(),this.initCamera()}))},reInitEnviro(){this.$q.loading.show(),navigator.mediaDevices.enumerateDevices().then((e=>{console.log(e);let t=null;const i=e.filter((e=>"videoinput"===e.kind)),o=i.map((e=>t={id:e.deviceId,label:e.label,group:e.groupId}));let a=null;const s=e.filter((e=>"audioinput"===e.kind));s.map((e=>a={id:e.deviceId,label:e.label,group:e.groupId}));this.device=o,this.audioInput=a,console.log(this.device),console.log(this.audioInput),this.selectCons()}))},initCamera(){console.log("init cam");this.$refs.video.deviceId;this.device.length>1?(console.log("have more than one cam",this.kamera),navigator.mediaDevices.getUserMedia(this.kamera).then((e=>{this.$refs.video.srcObject=e,this.$q.loading.hide()})).catch((e=>{this.hasCameraSupport=!1,this.$q.loading.hide()}))):(console.log("have  one cam"),this.kamera={video:!0},navigator.mediaDevices.getUserMedia(this.kamera).then((e=>{this.$refs.video.srcObject=e,this.$q.loading.hide()})).catch((e=>{this.hasCameraSupport=!1,this.$q.loading.hide()})))},coba(){this.$refs.video.srcObject=null,this.canUpload=!0,this.recording=!0,this.selectCons(),this.device.length||this.reInitEnviro();let e=this.$refs.video;navigator.mediaDevices.getUserMedia(this.kamera).then((t=>{this.$refs.video.srcObject=t,e.muted=!0;let i=new c(t,{type:"video",desiredSampRate:16e3,bufferSize:16384,numberOfAudioChannels:2,frameRate:20,bitrate:128e3,mimeType:"video/webm"});i.startRecording(),setTimeout((()=>{this.$refs.video.srcObject=null,i.stopRecording((t=>{let o=i.getBlob(),a=new File([o],"video.webm",{type:"video/webm"});this.videoData=a,e.muted=!1,e.volume=1,e.src=URL.createObjectURL(a),this.canUpload=!1,this.recording=!1,console.log("file ",o)}));i.getBlob()}),16e3)})).catch((e=>{this.recording=!1,this.$q.notify({message:"unable to capture your camera.",color:"negative",position:"center"}),console.log(e)}))},disableCamera(){this.$refs.video.srcObject.getVideoTracks().forEach((e=>{e.stop()}))},upload(){let e=new FormData;e.append("title","coba"),e.append("video",this.videoData),this.sendVideo(e)},dataURItoBlob(e){for(var t=atob(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],o=new ArrayBuffer(t.length),a=new Uint8Array(o),s=0;s<t.length;s++)a[s]=t.charCodeAt(s);var n=new Blob([o],{type:i}),l=new File([n],"video.webm",{type:i});return l},pesan(){this.sendMessage()},client(){let e={role:"admin"};this.getClient(e)},video(){},getDeviceMemory(){this.deviceMem=navigator.hardwareConcurrency,console.log(this.deviceMem)},write(){this.$q.localStorage.set("token","value lah"),console.log("local storage write"),this.$q.notify({message:"Local storage write.",color:"positive",position:"top"})},read(){const e=this.$q.localStorage.getItem("token");console.log("Local storage value ",e),this.$q.notify({message:"Local storage read."+e,color:"negative",position:"top-left"})},clear(){this.$q.localStorage.clear(),this.$q.notify({message:"Local storage cleared",color:"negative",position:"top-right"})}}),beforeDestroy(){this.disableCamera()}},d=r,h=(i("68f2"),i("2877")),g=i("9989"),v=i("9c40"),u=i("58a81"),m=i("27f9"),p=i("0016"),f=i("7cbe"),b=i("52ee"),C=i("ca78"),w=i("7f67"),q=i("eebe"),k=i.n(q),y=Object(h["a"])(d,o,a,!1,null,"44ed5f5e",null);t["default"]=y.exports;k()(y,"components",{QPage:g["a"],QBtn:v["a"],QBadge:u["a"],QInput:m["a"],QIcon:p["a"],QPopupProxy:f["a"],QDate:b["a"],QTime:C["a"]}),k()(y,"directives",{ClosePopup:w["a"]})}}]);