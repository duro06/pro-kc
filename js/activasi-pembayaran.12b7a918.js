(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{"8d48":function(e,t,a){},e33f:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[a("div",{staticClass:"camera-frame"},[a("video",{directives:[{name:"show",rawName:"v-show",value:!e.imageCaptured,expression:"!imageCaptured"}],ref:"video",staticClass:"full-width",attrs:{autoplay:""}}),a("canvas",{directives:[{name:"show",rawName:"v-show",value:e.imageCaptured,expression:"imageCaptured"}],ref:"canvas",staticClass:"full-width bg-grey",attrs:{height:"240"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.imageCaptured&&!e.hasCameraSupport,expression:"!imageCaptured && !hasCameraSupport"}],staticClass:"flex column flex-center full-height"},[a("div",[a("q-icon",{attrs:{size:"3em",name:"eva-image-2",color:"grey"}})],1),a("div",{staticClass:"text-grey"},[e._v("Belum Ada Gambar terpilih")]),a("div",{staticClass:"q-mt-md"},[a("q-btn",{attrs:{flat:"",dense:"",label:"Upload Image",color:"primary",icon:"eva-cloud-upload"},on:{click:e.getFile}})],1)])]),a("q-dialog",{attrs:{seamless:"",position:"bottom"},model:{value:e.tombol,callback:function(t){e.tombol=t},expression:"tombol"}},[a("q-card",{staticClass:"full-width",attrs:{dark:""}},[a("q-linear-progress",{attrs:{value:1,color:"dark"}}),a("q-card-section",{staticClass:"items-center no-wrap"},[a("div",{staticClass:"text-center q-pa-md"},[e.hasCameraSupport?a("div",[a("q-btn",{staticClass:"absolute-center q-mb-lg",attrs:{color:"primary",icon:"photo_camera",round:"",size:"lg",disable:e.disabledCameraBtn},on:{click:e.captureImage}}),e.device.length>1?a("q-btn",{staticClass:"absolute-right q-ma-md",attrs:{flat:"",icon:"flip_camera_ios",round:"",size:"md"},on:{click:e.switchCam}}):e._e()],1):a("div",[a("q-file",{ref:"myFileInput",staticStyle:{display:"none"},attrs:{outlined:"",color:"white",label:"Pilih Foto",accept:"image/*"},on:{input:e.captureImageFallback},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:"attach_file"}})]},proxy:!0}]),model:{value:e.imageUpload,callback:function(t){e.imageUpload=t},expression:"imageUpload"}}),a("q-btn",{staticClass:"glossy",attrs:{round:"",color:"secondary",icon:"perm_media",size:"lg"},on:{click:e.getFile}})],1)])])],1)],1),a("q-dialog",{attrs:{seamless:"",position:"bottom"},model:{value:e.seamless,callback:function(t){e.seamless=t},expression:"seamless"}},[a("q-card",{staticClass:"full-width",attrs:{dark:""}},[a("q-linear-progress",{attrs:{value:1,color:"dark"}}),a("q-card-section",{staticClass:"row items-center no-wrap"},[a("div",{staticClass:"q-pa-lg text-center"},[a("q-btn",{attrs:{flat:"",round:"",color:"white",icon:"done",size:"lg"},on:{click:function(t){return e.uploadImage()}}})],1),a("q-space"),a("div",{staticClass:"q-pa-lg text-center"},[a("q-btn",{attrs:{flat:"",round:"",color:"white",icon:"not_interested",size:"lg"},on:{click:function(t){return e.resetCapture()}}})],1)],1)],1)],1)],1)},i=[],o=(a("e6cf"),a("c19f"),a("ace4"),a("5cc6"),a("758b"));a("121f");var r={name:"PageFoto",data(){return{posts:{photo:null,date:Date.now()},imageCaptured:!1,imageUpload:[],hasCameraSupport:!0,disabledCameraBtn:!1,seamless:!1,tombol:!0,device:[],kamera:"",counter:1,urlSaveImage:"/transaction/upload_image"}},methods:{switchCam(){this.counter++,this.selectCons(),this.disableCamera(),this.$refs.video.srcObject=null,navigator.mediaDevices.getUserMedia(this.kamera).then((e=>{this.$refs.video.srcObject=e})).catch((e=>{this.hasCameraSupport=!1}))},selectCons(){let e=0;2==this.device.length&&(e=this.counter%2);let t=this.device[e].id;const a={video:{deviceId:t?{exact:t}:void 0}};this.kamera=a},initEnviro(){navigator.mediaDevices.enumerateDevices().then((e=>{console.log(e);let t=null;const a=e.filter((e=>"videoinput"===e.kind)),s=a.map((e=>t={id:e.deviceId,label:e.label,group:e.groupId}));this.device=s,console.log(this.device),this.selectCons(),this.initCamera()}))},initCamera(){"camera"===this.$route.params.slug?navigator.mediaDevices.getUserMedia(this.kamera).then((e=>{this.$refs.video.srcObject=e})).catch((e=>{this.hasCameraSupport=!1})):this.hasCameraSupport=!1},getFile(){this.$refs.myFileInput.$el.click()},captureImage(){let e=this.$refs.video,t=this.$refs.canvas;t.width=e.getBoundingClientRect().width,t.height=e.getBoundingClientRect().height;let a=t.getContext("2d");a.drawImage(e,0,0,t.width,t.height),this.imageCaptured=!0,this.posts.photo=this.dataURItoBlob(t.toDataURL()),this.disabledCameraBtn=!0,this.seamless=!0},captureImageFallback(e){this.posts.photo=e;let t=this.$refs.canvas,a=t.getContext("2d");var s=new FileReader;s.onload=e=>{var s=new Image;s.onload=()=>{t.width=s.width,t.height=s.height,a.drawImage(s,0,0),this.imageCaptured=!0},s.src=e.target.result},s.readAsDataURL(e),this.disabledCameraBtn=!0,this.seamless=!0},disableCamera(){this.$refs.video.srcObject.getVideoTracks().forEach((e=>{e.stop()}))},async uploadImage(){let e=this.posts.photo;const t=new FormData;t.append("image",e),this.$q.loading.show();try{await o["d"]().post(this.urlSaveImage,t);this.$q.notify({message:"Success, Gambar sudah tersimpan",icon:"eva-alert"}),this.$q.loading.hide()}catch(a){this.$q.loading.hide(),console.log(a),this.$q.notify({message:"error, Harap coba lagi",icon:"eva-alert"})}},getError(e,t){this.$store.dispatch("notification/addNotification",{type:e,message:t},{root:!0})},resetCapture(){this.seamless=!1,this.disabledCameraBtn=!1,this.imageCaptured=!1,this.posts.photo=""},dataURItoBlob(e){for(var t=atob(e.split(",")[1]),a=e.split(",")[0].split(":")[1].split(";")[0],s=new ArrayBuffer(t.length),i=new Uint8Array(s),o=0;o<t.length;o++)i[o]=t.charCodeAt(o);var r=new Blob([s],{type:a}),l=new File([r],"image.jpg",{type:a});return l}},mounted(){this.initEnviro()},beforeDestroy(){this.posts.foto="",this.hasCameraSupport&&this.disableCamera()}},l=r,n=(a("ee62"),a("2877")),c=a("9989"),d=a("0016"),h=a("9c40"),m=a("7d53"),p=a("24e8"),u=a("f09f"),g=a("6b1d"),v=a("a370"),C=a("2c91"),f=a("eebe"),b=a.n(f),w=Object(n["a"])(l,s,i,!1,null,null,null);t["default"]=w.exports;b()(w,"components",{QPage:c["a"],QIcon:d["a"],QBtn:h["a"],QFile:m["a"],QDialog:p["a"],QCard:u["a"],QLinearProgress:g["a"],QCardSection:v["a"],QSpace:C["a"]})},ee62:function(e,t,a){"use strict";a("8d48")}}]);