(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[30],{8799:function(e,t,i){"use strict";i("ad48")},ad48:function(e,t,i){},df3d:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-page",[i("div",{staticClass:"camera-frame"},[i("video",{ref:"video",staticClass:"full-width",attrs:{controls:!e.recording,autoplay:""}})]),i("q-dialog",{attrs:{seamless:"",position:"bottom"},model:{value:e.tombol,callback:function(t){e.tombol=t},expression:"tombol"}},[i("q-card",{staticClass:"full-width",attrs:{dark:""}},[i("q-linear-progress",{attrs:{value:e.time/e.fullTime,color:"dark"}}),i("q-card-section",{staticClass:"items-center no-wrap q-mb-lg"},[i("div",{staticClass:"text-center q-pa-md q-mb-lg q-ml-md"},[e.disabledCameraBtn?i("div",{staticClass:"absolute-top-left row"},[i("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.stillRecording,expression:"stillRecording"}],staticClass:"col",attrs:{dense:"",flat:"",icon:"circle",size:"xs","text-color":"red"}}),i("q-btn",{directives:[{name:"show",rawName:"v-show",value:!e.stillRecording,expression:"!stillRecording"}],staticClass:"col",attrs:{dense:"",flat:"",icon:"circle",size:"xs","text-color":"dark"}}),e.time>=10?i("p",{staticClass:"col q-mt-md"},[e._v("0:"+e._s(e.time))]):i("p",{staticClass:"col q-mt-md"},[e._v("0:0"+e._s(e.time))])],1):e._e(),e.disabledCameraBtn?e._e():i("q-btn",{staticClass:"absolute-center q-mb-lg",attrs:{color:"white","text-color":"primary",icon:"fas fa-video",round:"",size:"lg"},on:{click:e.captureImage}}),e.disabledCameraBtn?i("div",{staticClass:"absolute-center q-mb-lg"},[i("q-btn",{staticClass:"q-mr-lg",attrs:{dense:"","text-color":"primary",color:"white",icon:"stop",round:"",size:"lg"},on:{click:e.stopRecord}}),e.paused?e._e():i("q-btn",{attrs:{"text-color":"primary",color:"white",icon:"pause",round:"",size:"lg"},on:{click:e.pauseRecord}}),e.paused?i("q-btn",{attrs:{"text-color":"primary",color:"white",icon:"play_arrow",round:"",size:"lg"},on:{click:e.resumeRecord}}):e._e()],1):e._e(),e.device.length>1&&!e.disabledCameraBtn?i("q-btn",{staticClass:"absolute-right q-ma-md",attrs:{flat:"",icon:"flip_camera_ios",round:"",size:"md"},on:{click:e.switchCam}}):e._e()],1)])],1)],1),i("q-dialog",{attrs:{seamless:"",position:"bottom"},model:{value:e.seamless,callback:function(t){e.seamless=t},expression:"seamless"}},[i("q-card",{staticClass:"full-width",attrs:{dark:""}},[i("q-linear-progress",{attrs:{value:1,color:"dark"}}),i("q-card-section",{staticClass:"row items-center no-wrap"},[i("div",{staticClass:"q-pa-lg text-center"},[i("q-btn",{attrs:{flat:"",round:"",color:"white",icon:"done"},on:{click:e.upload}})],1),i("q-space"),i("div",{staticClass:"q-pa-lg text-center"},[i("q-btn",{attrs:{flat:"",round:"",color:"white",icon:"not_interested"},on:{click:e.resetCapture}})],1)],1)],1)],1)],1)},a=[],o=i("ded3"),r=i.n(o),l=(i("e6cf"),i("2b3d"),i("ddb0"),i("758b"),i("a9ee")),d=i("2f62");i("121f");var c={name:"PageFoto",data(){return{device:[],hasCameraSupport:!0,disabledCameraBtn:!1,seamless:!1,tombol:!0,videoData:null,canUpload:!0,recording:!0,kamera:"",counter:1,time:15,fullTime:15,doubleTime:null,stillRecording:!1,recorder:"",paused:!1}},methods:r()(r()({},Object(d["b"])("database",["sendVideo","sendMessage","getClient"])),{},{timer(){this.doubleTime>0&&setTimeout((()=>{this.paused||(this.doubleTime=this.doubleTime-1,this.time=this.time-1,this.stillRecording=!0),this.timerDua()}),500),console.log(this.doubleTime)},timerDua(){this.doubleTime>0&&setTimeout((()=>{this.paused||(this.doubleTime=this.doubleTime-1,this.stillRecording=!1),this.timer()}),500),console.log(this.doubleTime)},switchCam(){this.counter++,this.selectCons(),this.disableCamera(),this.$refs.video.srcObject=null,this.initCamera()},selectCons(){let e=0;2==this.device.length&&(e=this.counter%2);let t=this.device[e].id;const i={audio:!0,video:{deviceId:t?{exact:t}:void 0},echoCancelation:!0};this.kamera=i},initEnviro(){this.$q.loading.show(),navigator.mediaDevices.enumerateDevices().then((e=>{console.log(e);let t=null;const i=e.filter((e=>"videoinput"===e.kind)),s=i.map((e=>t={id:e.deviceId,label:e.label,group:e.groupId}));this.device=s,console.log(this.device),this.selectCons(),this.initCamera()}))},initCamera(){return this.$q.loading.hide(),this.$q.loading.show(),new Promise(((e,t)=>{navigator.mediaDevices.getUserMedia(this.kamera).then((t=>{this.$refs.video.srcObject=t,this.$refs.video.muted=!0,this.$q.loading.hide(),e(t),console.log("camera starting")})).catch((e=>{this.hasCameraSupport=!1,this.$q.loading.hide(),t(e),console.log("camera cant start",e)}))}))},initRecording(e){this.recorder=new l(e,{type:"video",desiredSampRate:16e3,bufferSize:16384,numberOfAudioChannels:2,frameRate:20,bitrate:128e3,mimeType:"video/webm",timeSlice:1e3,disableLogs:!0})},stopRecord(){this.recorder.stopRecording(this.stopRecordingCallback),this.doubleTime=0,this.time=0},pauseRecord(){this.paused=!0,this.recorder.pauseRecording()},resumeRecord(){this.paused=!1,this.recorder.resumeRecording()},stopRecordingCallback(e){this.$refs.video.srcObject=null;let t=this.$refs.video,i=this.recorder.getBlob(),s=new File([i],"video.webm",{type:"video/webm"});this.videoData=s,t.muted=!1,t.volume=1,t.src=URL.createObjectURL(i),this.canUpload=!1,this.recorder.camera.stop(),this.disabledCameraBtn=!1,this.seamless=!0,this.recording=!1,this.stillRecording=!1,this.recorder.destroy()},captureImage(){let e=15300;this.time=15,this.doubleTime=2*this.time,this.canUpload=!0;let t=this.$refs.video;this.recording=!0,this.disabledCameraBtn=!0,this.initCamera().then((i=>{t.muted=!0,t.volume=0,t.srcObject=i,this.initRecording(i),this.recorder.setRecordingDuration(e).onRecordingStopped((e=>{this.stopRecordingCallback(e)})),this.recorder.startRecording(),this.timer(),this.recorder.camera=i}))},upload(){let e=new FormData;e.append("video",this.videoData),this.$q.loading.show(),this.sendVideo(e).then((()=>{this.$q.loading.hide(),this.$q.notify({message:"Video Uploaded",color:"positive",position:"center"}),this.resetCapture()})).catch((()=>{this.$q.loading.hide(),this.$q.notify({message:"Video not Uploaded",color:"negative",position:"center"}),this.resetCapture()}))},resetCapture(){this.$refs.video.srcObject=null,this.$refs.video.src=null,this.seamless=!1,this.disabledCameraBtn=!1,this.imageCaptured=!1,this.videoData=null,this.recording=!0,this.initEnviro()},disableCamera(){let e=this.$refs.video.srcObject;null!=e&&this.$refs.video.srcObject.getVideoTracks().forEach((e=>{e.stop()}))}}),mounted(){this.initEnviro()},beforeDestroy(){this.videoData=null,this.disableCamera()}},n=c,h=(i("8799"),i("2877")),m=i("9989"),u=i("9c40"),p=i("7d53"),b=i("0016"),g=i("24e8"),v=i("f09f"),C=i("6b1d"),f=i("a370"),q=i("2c91"),w=i("eebe"),R=i.n(w),k=Object(h["a"])(n,s,a,!1,null,null,null);t["default"]=k.exports;R()(k,"components",{QPage:m["a"],QBtn:u["a"],QFile:p["a"],QIcon:b["a"],QDialog:g["a"],QCard:v["a"],QLinearProgress:C["a"],QCardSection:f["a"],QSpace:q["a"]})}}]);